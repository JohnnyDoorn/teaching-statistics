) +
theme_minimal(base_size = 14)
# Load libraries
library(ggplot2)
library(dplyr)
set.seed(42)
# Simulate data
n <- 50
therapy <- rep(c("CBT", "Mindfulness"), each = n)
baseline_stress <- c(
rnorm(n, mean = 70, sd = 8),  # higher baseline for CBT group
rnorm(n, mean = 55, sd = 8)   # lower baseline for Mindfulness group
)
post_stress <- 30 + 0.5 * baseline_stress -
ifelse(therapy == "Mindfulness", 5, 0) +
rnorm(2 * n, mean = 0, sd = 5)
df <- data.frame(
Therapy = as.factor(therapy),
BaselineStress = baseline_stress,
PostStress = post_stress
)
# --- Plot 1: Baseline stress differs by therapy type
ggplot(df, aes(x = Therapy, y = BaselineStress, fill = Therapy)) +
geom_boxplot(alpha = 0.7) +
scale_fill_brewer(palette = "Set2") +
labs(
title = "Dependent Predictors in ANCOVA Example",
subtitle = "Baseline stress differs by therapy type",
x = "Therapy Type",
y = "Baseline Stress Level"
) +
theme_minimal(base_size = 14) +
theme(legend.position = "none")
# --- Plot 2: Relationship between baseline and post-treatment stress
ggplot(df, aes(x = BaselineStress, y = PostStress, color = Therapy)) +
geom_point(size = 2) +
scale_color_brewer(palette = "Set2") +
labs(
title = "Different baseline distributions make predictors dependent",
x = "Baseline Stress",
y = "Post-Treatment Stress"
) +
theme_minimal(base_size = 14)
summary(lm())
summary(lm(PostStress ~ Therapy, data = df))
summary(lm(PostStress ~ Therapy + BaselineStress, data = df))
# Load libraries
library(ggplot2)
library(dplyr)
set.seed(42)
# Simulate data
n <- 50
therapy <- rep(c("CBT", "Mindfulness"), each = n)
baseline_stress <- c(
rnorm(n, mean = 70, sd = 8),  # higher baseline for CBT group
rnorm(n, mean = 55, sd = 8)   # lower baseline for Mindfulness group
)
post_stress <- 30 + 0.5 * baseline_stress -
ifelse(therapy == "Mindfulness", 0, 0) +
rnorm(2 * n, mean = 0, sd = 5)
df <- data.frame(
Therapy = as.factor(therapy),
BaselineStress = baseline_stress,
PostStress = post_stress
)
# --- Plot 1: Baseline stress differs by therapy type
ggplot(df, aes(x = Therapy, y = BaselineStress, fill = Therapy)) +
geom_boxplot(alpha = 0.7) +
scale_fill_brewer(palette = "Set2") +
labs(
title = "Dependent Predictors in ANCOVA Example",
subtitle = "Baseline stress differs by therapy type",
x = "Therapy Type",
y = "Baseline Stress Level"
) +
theme_minimal(base_size = 14) +
theme(legend.position = "none")
# --- Plot 2: Relationship between baseline and post-treatment stress
ggplot(df, aes(x = BaselineStress, y = PostStress, color = Therapy)) +
geom_point(size = 2) +
scale_color_brewer(palette = "Set2") +
labs(
title = "Different baseline distributions make predictors dependent",
x = "Baseline Stress",
y = "Post-Treatment Stress"
) +
theme_minimal(base_size = 14)
summary(lm(PostStress ~ Therapy, data = df))
summary(lm(PostStress ~ Therapy + BaselineStress, data = df))
# Load libraries
library(ggplot2)
library(dplyr)
set.seed(42)
# Simulate data
n <- 50
therapy <- rep(c("CBT", "Mindfulness"), each = n)
baseline_stress <- c(
rnorm(n, mean = 70, sd = 8),  # higher baseline for CBT group
rnorm(n, mean = 55, sd = 8)   # lower baseline for Mindfulness group
)
post_stress <- 30 + 0.2 * baseline_stress -
ifelse(therapy == "Mindfulness", 0, 0) +
rnorm(2 * n, mean = 0, sd = 5)
df <- data.frame(
Therapy = as.factor(therapy),
BaselineStress = baseline_stress,
PostStress = post_stress
)
# --- Plot 1: Baseline stress differs by therapy type
ggplot(df, aes(x = Therapy, y = BaselineStress, fill = Therapy)) +
geom_boxplot(alpha = 0.7) +
scale_fill_brewer(palette = "Set2") +
labs(
title = "Dependent Predictors in ANCOVA Example",
subtitle = "Baseline stress differs by therapy type",
x = "Therapy Type",
y = "Baseline Stress Level"
) +
theme_minimal(base_size = 14) +
theme(legend.position = "none")
# --- Plot 2: Relationship between baseline and post-treatment stress
ggplot(df, aes(x = BaselineStress, y = PostStress, color = Therapy)) +
geom_point(size = 2) +
scale_color_brewer(palette = "Set2") +
labs(
title = "Different baseline distributions make predictors dependent",
x = "Baseline Stress",
y = "Post-Treatment Stress"
) +
theme_minimal(base_size = 14)
summary(lm(PostStress ~ Therapy, data = df))
summary(lm(PostStress ~ Therapy + BaselineStress, data = df))
# Load libraries
library(ggplot2)
library(dplyr)
set.seed(42)
# Simulate data
n <- 50
therapy <- rep(c("CBT", "Mindfulness"), each = n)
baseline_stress <- c(
rnorm(n, mean = 70, sd = 8),  # higher baseline for CBT group
rnorm(n, mean = 55, sd = 8)   # lower baseline for Mindfulness group
)
post_stress <- 30 + 0.1 * baseline_stress -
ifelse(therapy == "Mindfulness", 0, 0) +
rnorm(2 * n, mean = 0, sd = 5)
df <- data.frame(
Therapy = as.factor(therapy),
BaselineStress = baseline_stress,
PostStress = post_stress
)
# --- Plot 1: Baseline stress differs by therapy type
ggplot(df, aes(x = Therapy, y = BaselineStress, fill = Therapy)) +
geom_boxplot(alpha = 0.7) +
scale_fill_brewer(palette = "Set2") +
labs(
title = "Dependent Predictors in ANCOVA Example",
subtitle = "Baseline stress differs by therapy type",
x = "Therapy Type",
y = "Baseline Stress Level"
) +
theme_minimal(base_size = 14) +
theme(legend.position = "none")
# --- Plot 2: Relationship between baseline and post-treatment stress
ggplot(df, aes(x = BaselineStress, y = PostStress, color = Therapy)) +
geom_point(size = 2) +
scale_color_brewer(palette = "Set2") +
labs(
title = "Different baseline distributions make predictors dependent",
x = "Baseline Stress",
y = "Post-Treatment Stress"
) +
theme_minimal(base_size = 14)
summary(lm(PostStress ~ Therapy, data = df))
summary(lm(PostStress ~ Therapy + BaselineStress, data = df))
# Load libraries
library(ggplot2)
library(dplyr)
set.seed(42)
# Simulate data
n <- 50
therapy <- rep(c("CBT", "Mindfulness"), each = n)
baseline_stress <- c(
rnorm(n, mean = 80, sd = 8),  # higher baseline for CBT group
rnorm(n, mean = 55, sd = 8)   # lower baseline for Mindfulness group
)
post_stress <- 30 + 0.1 * baseline_stress -
ifelse(therapy == "Mindfulness", 0, 0) +
rnorm(2 * n, mean = 0, sd = 5)
df <- data.frame(
Therapy = as.factor(therapy),
BaselineStress = baseline_stress,
PostStress = post_stress
)
# --- Plot 1: Baseline stress differs by therapy type
ggplot(df, aes(x = Therapy, y = BaselineStress, fill = Therapy)) +
geom_boxplot(alpha = 0.7) +
scale_fill_brewer(palette = "Set2") +
labs(
title = "Dependent Predictors in ANCOVA Example",
subtitle = "Baseline stress differs by therapy type",
x = "Therapy Type",
y = "Baseline Stress Level"
) +
theme_minimal(base_size = 14) +
theme(legend.position = "none")
# --- Plot 2: Relationship between baseline and post-treatment stress
ggplot(df, aes(x = BaselineStress, y = PostStress, color = Therapy)) +
geom_point(size = 2) +
scale_color_brewer(palette = "Set2") +
labs(
title = "Different baseline distributions make predictors dependent",
x = "Baseline Stress",
y = "Post-Treatment Stress"
) +
theme_minimal(base_size = 14)
summary(lm(PostStress ~ Therapy, data = df))
summary(lm(PostStress ~ Therapy + BaselineStress, data = df))
summary(lm(PostStress ~ BaselineStress, data = df))
# Load libraries
library(ggplot2)
library(dplyr)
set.seed(42)
# Simulate data
n <- 50
therapy <- rep(c("CBT", "Mindfulness"), each = n)
baseline_stress <- c(
rnorm(n, mean = 80, sd = 5),  # higher baseline for CBT group
rnorm(n, mean = 55, sd = 5)   # lower baseline for Mindfulness group
)
post_stress <- 30 + 0.1 * baseline_stress -
ifelse(therapy == "Mindfulness", 0, 0) +
rnorm(2 * n, mean = 0, sd = 5)
df <- data.frame(
Therapy = as.factor(therapy),
BaselineStress = baseline_stress,
PostStress = post_stress
)
# --- Plot 1: Baseline stress differs by therapy type
ggplot(df, aes(x = Therapy, y = BaselineStress, fill = Therapy)) +
geom_boxplot(alpha = 0.7) +
scale_fill_brewer(palette = "Set2") +
labs(
title = "Dependent Predictors in ANCOVA Example",
subtitle = "Baseline stress differs by therapy type",
x = "Therapy Type",
y = "Baseline Stress Level"
) +
theme_minimal(base_size = 14) +
theme(legend.position = "none")
# --- Plot 2: Relationship between baseline and post-treatment stress
ggplot(df, aes(x = BaselineStress, y = PostStress, color = Therapy)) +
geom_point(size = 2) +
scale_color_brewer(palette = "Set2") +
labs(
title = "Different baseline distributions make predictors dependent",
x = "Baseline Stress",
y = "Post-Treatment Stress"
) +
theme_minimal(base_size = 14)
summary(lm(PostStress ~ Therapy, data = df))
summary(lm(PostStress ~ Therapy + BaselineStress, data = df))
summary(lm(PostStress ~ BaselineStress, data = df))
# Load libraries
library(ggplot2)
library(dplyr)
set.seed(42)
# Simulate data
n <- 50
therapy <- rep(c("CBT", "Mindfulness"), each = n)
baseline_stress <- c(
rnorm(n, mean = 80, sd = 5),  # higher baseline for CBT group
rnorm(n, mean = 55, sd = 5)   # lower baseline for Mindfulness group
)
post_stress <- 30 + 0.1 * baseline_stress -
ifelse(therapy == "Mindfulness", 1, 0) +
rnorm(2 * n, mean = 0, sd = 5)
df <- data.frame(
Therapy = as.factor(therapy),
BaselineStress = baseline_stress,
PostStress = post_stress
)
# --- Plot 1: Baseline stress differs by therapy type
ggplot(df, aes(x = Therapy, y = BaselineStress, fill = Therapy)) +
geom_boxplot(alpha = 0.7) +
scale_fill_brewer(palette = "Set2") +
labs(
title = "Dependent Predictors in ANCOVA Example",
subtitle = "Baseline stress differs by therapy type",
x = "Therapy Type",
y = "Baseline Stress Level"
) +
theme_minimal(base_size = 14) +
theme(legend.position = "none")
# --- Plot 2: Relationship between baseline and post-treatment stress
ggplot(df, aes(x = BaselineStress, y = PostStress, color = Therapy)) +
geom_point(size = 2) +
scale_color_brewer(palette = "Set2") +
labs(
title = "Different baseline distributions make predictors dependent",
x = "Baseline Stress",
y = "Post-Treatment Stress"
) +
theme_minimal(base_size = 14)
summary(lm(PostStress ~ Therapy, data = df))
summary(lm(PostStress ~ Therapy + BaselineStress, data = df))
summary(lm(PostStress ~ BaselineStress, data = df))
write.csv(df,  "dependenceANCOVA.csv", row.names = FALSE)
getwd()
# Load libraries
library(ggplot2)
library(dplyr)
set.seed(42)
# Simulate data
n <- 50
therapy <- rep(c("CBT", "Mindfulness"), each = n)
baseline_stress <- c(
rnorm(n, mean = 80, sd = 5),  # higher baseline for CBT group
rnorm(n, mean = 55, sd = 5)   # lower baseline for Mindfulness group
)
post_stress <- 30 + 0.1 * baseline_stress -
ifelse(therapy == "Mindfulness", 1, 0) +
rnorm(2 * n, mean = 0, sd = 5)
df <- data.frame(
Therapy = as.factor(therapy),
Neuroticism = baseline_stress,
PostStress = post_stress
)
# --- Plot 1: Baseline stress differs by therapy type
ggplot(df, aes(x = Therapy, y = Neuroticism, fill = Therapy)) +
geom_boxplot(alpha = 0.7) +
scale_fill_brewer(palette = "Set2") +
labs(
title = "Dependent Predictors in ANCOVA Example",
subtitle = "Neuroticism differs by therapy type",
x = "Therapy Type",
y = "Neuroticism Level"
) +
theme_minimal(base_size = 14) +
theme(legend.position = "none")
# --- Plot 2: Relationship between baseline and post-treatment stress
ggplot(df, aes(x = BaselineStress, y = PostStress, color = Therapy)) +
geom_point(size = 2) +
scale_color_brewer(palette = "Set2") +
labs(
title = "Neuroticism distributions make predictors dependent",
x = "Neuroticism",
y = "Post-Treatment Stress"
) +
theme_minimal(base_size = 14)
# Load libraries
library(ggplot2)
library(dplyr)
set.seed(42)
# Simulate data
n <- 50
therapy <- rep(c("CBT", "Mindfulness"), each = n)
baseline_stress <- c(
rnorm(n, mean = 80, sd = 5),  # higher baseline for CBT group
rnorm(n, mean = 55, sd = 5)   # lower baseline for Mindfulness group
)
post_stress <- 30 + 0.1 * baseline_stress -
ifelse(therapy == "Mindfulness", 1, 0) +
rnorm(2 * n, mean = 0, sd = 5)
df <- data.frame(
Therapy = as.factor(therapy),
Neuroticism = baseline_stress,
PostStress = post_stress
)
# --- Plot 1: Baseline stress differs by therapy type
ggplot(df, aes(x = Therapy, y = Neuroticism, fill = Therapy)) +
geom_boxplot(alpha = 0.7) +
scale_fill_brewer(palette = "Set2") +
labs(
title = "Dependent Predictors in ANCOVA Example",
subtitle = "Neuroticism differs by therapy type",
x = "Therapy Type",
y = "Neuroticism Level"
) +
theme_minimal(base_size = 14) +
theme(legend.position = "none")
# --- Plot 2: Relationship between baseline and post-treatment stress
ggplot(df, aes(x = Neuroticism, y = PostStress, color = Therapy)) +
geom_point(size = 2) +
scale_color_brewer(palette = "Set2") +
labs(
title = "Neuroticism distributions make predictors dependent",
x = "Neuroticism",
y = "Post-Treatment Stress"
) +
theme_minimal(base_size = 14)
summary(lm(PostStress ~ Therapy, data = df))
summary(lm(PostStress ~ Therapy + Neuroticism, data = df))
summary(lm(PostStress ~ Neuroticism, data = df))
write.csv(df,  "dependenceANCOVA.csv", row.names = FALSE)
sqrt(0.008)
3.053^2
# --- Plot 1: Baseline stress differs by therapy type
ggplot(df, aes(x = Therapy, y = PostStress, fill = Therapy)) +
geom_boxplot(alpha = 0.7) +
scale_fill_brewer(palette = "Set2") +
labs(
title = "Dependent Predictors in ANCOVA Example",
subtitle = "PostStress differs by therapy type",
x = "Therapy Type",
y = "PostStress Level"
) +
theme_minimal(base_size = 14) +
theme(legend.position = "none")
files <- list.files(full.names = FALSE, pattern = "\\qmd", recursive = FALSE, path = "../extra-texts")
lectures <- data.frame()
n <- length(files)
files <- files[order(as.numeric(gsub("\\..*", "", files)))]
files <- files[files!= "OverviewSSR.qmd"]
htmlFiles <- gsub(x =files, pattern = ".qmd", replacement = ".html")
htmlFiles <- htmlFiles[htmlFiles %in% c("OneSidedVsTwoSided.html","Heteroscedasticity.html", "EffSizeVsTestStat.html", "ViolatingAssumptionsANOVA.html", "PredictingWithDummies_1Variable.html", "PredictingWithDummies_2Variables.html")]
allLinks <- sprintf('<a href="https://johnnydoorn.github.io/teaching-statistics/extra-texts/%s" target="_blank" class="external">link</a>',htmlFiles)
titles <- gsub(htmlFiles, pattern = ".html", replacement = "")
linkList <- data.frame(Topic = titles, Links = allLinks)
knitr::kable(dplyr::arrange(linkList), escape = FALSE, format = "html"  ) %>%
kable_styling(full_width = TRUE)
files
files <- list.files(full.names = FALSE, pattern = "\\jasp", recursive = FALSE,
path = "../datasets/2025")
files <- files[order(as.numeric(gsub("\\..*", "", files)))]
files <- files[files!= "OverviewSSR.qmd"]
htmlFiles <- gsub(x =files, pattern = ".jasp", replacement = ".html")
htmlFound <- list.files(full.names = FALSE, pattern = "\\html", recursive = FALSE,
path = "../datasets/2025")
csvFound  <- list.files(full.names = FALSE, pattern = "\\csv", recursive = FALSE,
path = "../datasets/2025")
htmlLinks <- sprintf('<a href="https://johnnydoorn.github.io/teaching-statistics/datasets/2025/%s" target="_blank" class="external">link</a>',htmlFiles)
htmlLinks[!(htmlFiles %in% htmlFound)] <- "-"
jaspLinks <- sprintf('<a href="https://johnnydoorn.github.io/teaching-statistics/datasets/2025/%s" target="_blank"
class="external">link</a>',files)
titles <- gsub(htmlFiles, pattern = ".html", replacement = "")
csvFiles <- gsub(x =files, pattern = ".jasp", replacement = ".csv")
csvLinks <- sprintf('<a href="https://johnnydoorn.github.io/teaching-statistics/datasets/2025/%s" target="_blank" class="external">link</a>',csvFiles)
csvLinks[!(csvFiles %in% csvFound)] <- "-"
linkList <- data.frame(Topic = titles, Data = jaspLinks, HtmlResults = htmlLinks)
knitr::kable(dplyr::arrange(linkList), escape = FALSE, format = "html"  ) %>%
kable_styling(full_width = TRUE)
files
files <- list.files(full.names = FALSE, pattern = "\\jasp", recursive = FALSE,
path = "../datasets/2025")
files
files[!grepl("-result", files)]
files <- list.files(full.names = FALSE, pattern = "\\jasp", recursive = FALSE,
path = "../datasets/2025")
files <- files[order(as.numeric(gsub("\\..*", "", files)))]
files <- files[order(as.numeric(gsub("\\..*", "", files)))]
files <- files[files!= "OverviewSSR.qmd"]
resultFiles <- files[grepl("-result", files)]
resultFiles <- files[grepl("-result", files)]
files <- files[!grepl("-result", files)]
htmlFiles <- gsub(x =files, pattern = ".jasp", replacement = ".html")
htmlFiles <- gsub(x =files, pattern = ".jasp", replacement = ".html")
htmlFound <- list.files(full.names = FALSE, pattern = "\\html", recursive = FALSE,
path = "../datasets/2025")
jaspResultsFound <- list.files(full.names = FALSE, pattern = "\\-results.jasp", recursive = FALSE,
path = "../datasets/2025")
csvFound  <- list.files(full.names = FALSE, pattern = "\\csv", recursive = FALSE,
path = "../datasets/2025")
jaspResultsFound
jaspResultsFound <- list.files(full.names = FALSE, pattern = "\\-results", recursive = FALSE,
path = "../datasets/2025")
jaspResultsFound
jaspResultsFound <- list.files(full.names = FALSE, pattern = "\\results", recursive = FALSE,
path = "../datasets/2025")
jaspResultsFound
jaspResultsFound <- list.files(full.names = FALSE, pattern = "\\result", recursive = FALSE,
path = "../datasets/2025")
jaspResultsFound
jaspResultsFound <- list.files(full.names = FALSE, pattern = "result", recursive = FALSE,
path = "../datasets/2025")
jaspResultsFound
jaspResultsFound <- list.files(full.names = FALSE, pattern = "result.jasp", recursive = FALSE,
path = "../datasets/2025")
jaspResultsFound
jaspResultsLinks[!(jaspResultsLinks %in% jaspResultsFound)]
htmlFiles <- gsub(x =files, pattern = ".jasp", replacement = ".html")
htmlFiles <- gsub(x =files, pattern = ".jasp", replacement = ".html")
htmlFound <- list.files(full.names = FALSE, pattern = "\\html", recursive = FALSE,
path = "../datasets/2025")
jaspResultsFound <- list.files(full.names = FALSE, pattern = "result.jasp", recursive = FALSE,
path = "../datasets/2025")
csvFound  <- list.files(full.names = FALSE, pattern = "\\csv", recursive = FALSE,
path = "../datasets/2025")
htmlLinks <- sprintf('<a href="https://johnnydoorn.github.io/teaching-statistics/datasets/2025/%s" target="_blank" class="external">link</a>',htmlFiles)
htmlLinks <- sprintf('<a href="https://johnnydoorn.github.io/teaching-statistics/datasets/2025/%s" target="_blank" class="external">link</a>',htmlFiles)
htmlLinks[!(htmlFiles %in% htmlFound)] <- "-"
jaspLinks <- sprintf('<a href="https://johnnydoorn.github.io/teaching-statistics/datasets/2025/%s" target="_blank"
class="external">link</a>',files)
jaspResultsLinks <- sprintf('<a href="https://johnnydoorn.github.io/teaching-statistics/datasets/2025/%s" target="_blank"
class="external">link</a>',resultFiles)
jaspResultsLinks[!(jaspResultsLinks %in% jaspResultsFound)] <- "-"
jaspResultsLinks
jaspResultsLinks <- sprintf('<a href="https://johnnydoorn.github.io/teaching-statistics/datasets/2025/%s" target="_blank"
class="external">link</a>',resultFiles)
jaspResultsLinks
!(resultFiles %in% jaspResultsFound)
files
csvFound
htmlLinks
resultFiles
source("~/GitHubStuff/teaching-statistics/SSR/2024/renderAllLectures.R")
source("~/GitHubStuff/teaching-statistics/SSR/2024/renderAllLectures.R")
files
source("~/GitHubStuff/teaching-statistics/SSR/2024/renderAllLectures.R")
shiny::runApp('~/GitHubStuff/ShinyApps/ShinyApps/RM_ANOVA')
20.725 / 16.221
20.725 / 16.554
