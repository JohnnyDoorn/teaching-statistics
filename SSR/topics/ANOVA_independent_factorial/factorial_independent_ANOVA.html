<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Johnny van Doorn”">

<title>factorial_independent_anova</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="factorial_independent_ANOVA_files/libs/clipboard/clipboard.min.js"></script>
<script src="factorial_independent_ANOVA_files/libs/quarto-html/quarto.js"></script>
<script src="factorial_independent_ANOVA_files/libs/quarto-html/popper.min.js"></script>
<script src="factorial_independent_ANOVA_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="factorial_independent_ANOVA_files/libs/quarto-html/anchor.min.js"></script>
<link href="factorial_independent_ANOVA_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="factorial_independent_ANOVA_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="factorial_independent_ANOVA_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="factorial_independent_ANOVA_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="factorial_independent_ANOVA_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<link href="factorial_independent_ANOVA_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="factorial_independent_ANOVA_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="factorial_independent_ANOVA_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="factorial_independent_ANOVA_files/libs/datatables-binding-0.33/datatables.js"></script>
<script src="factorial_independent_ANOVA_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="factorial_independent_ANOVA_files/libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="factorial_independent_ANOVA_files/libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="factorial_independent_ANOVA_files/libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="factorial_independent_ANOVA_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="factorial_independent_ANOVA_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#independent-factorial-anova" id="toc-independent-factorial-anova" class="nav-link active" data-scroll-target="#independent-factorial-anova">Independent factorial ANOVA</a>
  <ul class="collapse">
  <li><a href="#independent-factorial-anova-1" id="toc-independent-factorial-anova-1" class="nav-link" data-scroll-target="#independent-factorial-anova-1">Independent factorial ANOVA</a></li>
  <li><a href="#assumptions" id="toc-assumptions" class="nav-link" data-scroll-target="#assumptions">Assumptions</a></li>
  <li><a href="#formulas" id="toc-formulas" class="nav-link" data-scroll-target="#formulas">Formulas</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a></li>
  <li><a href="#ss-full-model" id="toc-ss-full-model" class="nav-link" data-scroll-target="#ss-full-model">SS full model</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  <li><a href="#group-means" id="toc-group-means" class="nav-link" data-scroll-target="#group-means">Group means</a></li>
  <li><a href="#ss-model-visual" id="toc-ss-model-visual" class="nav-link" data-scroll-target="#ss-model-visual">SS model visual</a></li>
  <li><a href="#ss-error" id="toc-ss-error" class="nav-link" data-scroll-target="#ss-error">SS error</a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"></a></li>
  <li><a href="#ss-error-visual" id="toc-ss-error-visual" class="nav-link" data-scroll-target="#ss-error-visual">SS error visual</a></li>
  <li><a href="#ss-a-speed" id="toc-ss-a-speed" class="nav-link" data-scroll-target="#ss-a-speed">SS A Speed</a></li>
  <li><a href="#ss-a-speed-visual" id="toc-ss-a-speed-visual" class="nav-link" data-scroll-target="#ss-a-speed-visual">SS A Speed Visual</a></li>
  <li><a href="#ss-a-speed-error-visual" id="toc-ss-a-speed-error-visual" class="nav-link" data-scroll-target="#ss-a-speed-error-visual">SS A Speed Error Visual</a></li>
  <li><a href="#ss-b-alcohol" id="toc-ss-b-alcohol" class="nav-link" data-scroll-target="#ss-b-alcohol">SS B Alcohol</a></li>
  <li><a href="#ss-b-alcohol-visual" id="toc-ss-b-alcohol-visual" class="nav-link" data-scroll-target="#ss-b-alcohol-visual">SS B Alcohol Visual</a></li>
  <li><a href="#ss-b-alcohol-error-visual" id="toc-ss-b-alcohol-error-visual" class="nav-link" data-scroll-target="#ss-b-alcohol-error-visual">SS B Alcohol Error Visual</a></li>
  <li><a href="#ss-ab-alcohol-x-speed" id="toc-ss-ab-alcohol-x-speed" class="nav-link" data-scroll-target="#ss-ab-alcohol-x-speed">SS AB Alcohol x Speed</a></li>
  <li><a href="#mean-squares" id="toc-mean-squares" class="nav-link" data-scroll-target="#mean-squares">Mean Squares</a></li>
  <li><a href="#interaction" id="toc-interaction" class="nav-link" data-scroll-target="#interaction">Interaction</a></li>
  <li><a href="#p-value" id="toc-p-value" class="nav-link" data-scroll-target="#p-value"><span class="math inline">\(P\)</span>-value</a></li>
  <li><a href="#partition-the-explained-variance-bonus" id="toc-partition-the-explained-variance-bonus" class="nav-link" data-scroll-target="#partition-the-explained-variance-bonus">Partition the explained variance (BONUS)</a></li>
  <li><a href="#partition-the-explained-variance-bonus-1" id="toc-partition-the-explained-variance-bonus-1" class="nav-link" data-scroll-target="#partition-the-explained-variance-bonus-1">Partition the explained variance (BONUS)</a></li>
  <li><a href="#partition-the-explained-variance-bonus-2" id="toc-partition-the-explained-variance-bonus-2" class="nav-link" data-scroll-target="#partition-the-explained-variance-bonus-2">Partition the explained variance (BONUS)</a></li>
  <li><a href="#contrast" id="toc-contrast" class="nav-link" data-scroll-target="#contrast">Contrast</a></li>
  <li><a href="#post-hoc" id="toc-post-hoc" class="nav-link" data-scroll-target="#post-hoc">Post-Hoc</a></li>
  <li><a href="#effect-size-in-anova" id="toc-effect-size-in-anova" class="nav-link" data-scroll-target="#effect-size-in-anova">Effect size in ANOVA</a></li>
  <li><a href="#effect-size-in-follow-up-tests" id="toc-effect-size-in-follow-up-tests" class="nav-link" data-scroll-target="#effect-size-in-follow-up-tests">Effect size in follow-up tests</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="factorial_independent_ANOVA.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">



<section id="independent-factorial-anova" class="level1 section">
<h1 class="section">Independent factorial ANOVA</h1>
<p>Two or more independent variables with two or more categories. One dependent variable.</p>
<section id="independent-factorial-anova-1" class="level2">
<h2 class="anchored" data-anchor-id="independent-factorial-anova-1">Independent factorial ANOVA</h2>
<p>The independent factorial ANOVA analyses the variance of multiple independent variables (Factors) with two or more categories.</p>
<p>Effects and interactions:</p>
<ul>
<li>1 dependent/outcome variable</li>
<li>2 or more independent/predictor variables
<ul>
<li>2 or more cat./levels</li>
</ul></li>
</ul>
</section>
<section id="assumptions" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="assumptions">Assumptions</h2>
<ul>
<li>Continuous variable</li>
<li>Random sample</li>
<li>Normally distributed
<ul>
<li>Q-Q plot</li>
</ul></li>
<li>Equal variance within groups
<ul>
<li>Ratio of observed sd’s</li>
<li>Welch correction only exists for one-way ANOVA</li>
</ul></li>
</ul>
</section>
<section id="formulas" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="formulas">Formulas</h2>
<table class="table">
<colgroup>
<col style="width: 18%">
<col style="width: 30%">
<col style="width: 7%">
<col style="width: 26%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Variance</th>
<th>Sum of squares</th>
<th>df</th>
<th>Mean squares</th>
<th>F-ratio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Model</td>
<td><span class="math inline">\(\text{SS}_{\text{model}} = \sum{n_k(\bar{X}_k-\bar{X})^2}\)</span></td>
<td><span class="math inline">\(k_{model}-1\)</span></td>
<td><span class="math inline">\(\frac{\text{SS}_{\text{model}}}{\text{df}_{\text{model}}}\)</span></td>
<td><span class="math inline">\(\frac{\text{MS}_{\text{model}}}{\text{MS}_{\text{error}}}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\hspace{2ex}A\)</span></td>
<td><span class="math inline">\(\text{SS}_{\text{A}} = \sum{n_k(\bar{X}_k-\bar{X})^2}\)</span></td>
<td><span class="math inline">\(k_A-1\)</span></td>
<td><span class="math inline">\(\frac{\text{SS}_{\text{A}}}{\text{df}_{\text{A}}}\)</span></td>
<td><span class="math inline">\(\frac{\text{MS}_{\text{A}}}{\text{MS}_{\text{error}}}\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\hspace{2ex}B\)</span></td>
<td><span class="math inline">\(\text{SS}_{\text{B}} = \sum{n_k(\bar{X}_k-\bar{X})^2}\)</span></td>
<td><span class="math inline">\(k_B-1\)</span></td>
<td><span class="math inline">\(\frac{\text{SS}_{\text{B}}}{\text{df}_{\text{B}}}\)</span></td>
<td><span class="math inline">\(\frac{\text{MS}_{\text{B}}}{\text{MS}_{\text{error}}}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\hspace{2ex}AB\)</span></td>
<td><span class="math inline">\(\text{SS}_{A \times B} = \text{SS}_{\text{model}} - \text{SS}_{\text{A}} - \text{SS}_{\text{B}}\)</span></td>
<td><span class="math inline">\(df_A \times df_B\)</span></td>
<td><span class="math inline">\(\frac{\text{SS}_{\text{AB}}}{\text{df}_{\text{AB}}}\)</span></td>
<td><span class="math inline">\(\frac{\text{MS}_{\text{AB}}}{\text{MS}_{\text{error}}}\)</span></td>
</tr>
<tr class="odd">
<td>Error</td>
<td><span class="math inline">\(\text{SS}_{\text{error}} = \sum{s_k^2(n_k-1)}\)</span></td>
<td><span class="math inline">\(N-k_{model}\)</span></td>
<td><span class="math inline">\(\frac{\text{SS}_{\text{error}}}{\text{df}_{\text{error}}}\)</span></td>
<td></td>
</tr>
<tr class="even">
<td>Total</td>
<td><span class="math inline">\(\text{SS}_{\text{total}} = \text{SS}_{\text{model}} + \text{SS}_{\text{error}}\)</span></td>
<td><span class="math inline">\(N-1\)</span></td>
<td><span class="math inline">\(\frac{\text{SS}_{\text{total}}}{\text{df}_{\text{total}}}\)</span></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="example" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="example">Example</h2>
<p>In this example we will look at the amount of accidents in a car driving simulator while subjects where given varying doses of speed and alcohol.</p>
<ul>
<li>Dependent variable
<ul>
<li>Accidents</li>
</ul></li>
<li>Independent variables
<ul>
<li>Speed dose
<ul>
<li>None / Small / Large</li>
</ul></li>
<li>Alcohol dose
<ul>
<li>None / small / large</li>
</ul></li>
</ul></li>
</ul>
<!-- ## -->
<!-- person | alcohol | speed | accidents -->
<!-- -------|---------|-------|---------- -->
<!-- 1      | 1       | 1     | 0 -->
<!-- 2      | 1       | 2     | 2 -->
<!-- 3      | 1       | 3     | 4 -->
<!-- 4      | 2       | 1     | 6 -->
<!-- 5      | 2       | 2     | 8 -->
<!-- 6      | 2       | 3     | 10 -->
<!-- 7      | 3       | 1     | 12 -->
<!-- 8      | 3       | 2     | 14 -->
<!-- 9      | 3       | 3     | 16 -->
</section>
<section id="data" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="data">Data</h2>
<div class="cell">
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item" id="htmlwidget-e94412990413c168b7d5" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e94412990413c168b7d5">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180"],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180],["morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening","morning","evening"],["none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)"],["none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)"],[2.67,2.64,2.39,2.13,2.16,2.33,1.79,2.37,1.91,1.78,1.56,2.6,2.55,1.8,1.6,2.3,2.27,1.77,2.75,0.75,1.85,2.96,2.68,2.63,2.63,2.98,2.19,3.35,3.03,3.24,3.34,3.37,2.4,3.02,2.25,4.03,3.78,3.11,2.66,3.39,3.52,4.17,4.02,3.91,3.13,3.42,3.5,3.24,4.01,3.82,4.16,4.27,3.55,4.73,4.26,3.63,4.52,4.11,3.12,4.67,3.26,3.46,2.35,4.1,3.46,3.46,3.66,3.78,2.86,3.51,2.95,4.09,3.15,4.2,3.03,3.83,2.72,4.18,3.06,3.76,4.39,4.35,4.8,5.1,3.89,5.38,4.34,5.48,3.49,5.03,4.19,5.39,4.87,5.8,4.03,5.02,4.18,5.55,4.44,5.53,5.13,6.81,5.34,5.33,4.56,5.16,5.76,6.59,4.64,5.64,6.31,6.71,5.03,5.73,5.3,5.7,5.02,5.69,5.06,6.07,4.51,6.44,4.9,5.54,4.59,6.26,4.34,5.91,5.5,5.88,4.24,5.23,4.78,6.03,4.46,5.87,4.33,5.39,5.61,6.13,6.12,6.95,7,6.36,6.49,7.49,5.44,7.24,6.17,6.76,5.93,7.48,5.09,7.11,6,7.07,6.15,7.61,5.21,6.58,6.46,8.210000000000001,6.82,7.66,6.9,7.54,7.98,7.49,7.26,8.800000000000001,7.04,8.550000000000001,7.32,7.73,7.08,8.42,7.05,6.97,7.09,9.07],[70.29000000000001,66.44,59.2,58.86,77.26000000000001,81.83,70.88,52.06,72.28,67.53,64.40000000000001,73.64,72.48,68.63,68.31999999999999,66.63,69.16,62.63,76.68000000000001,58.42,59.55,66.79000000000001,66.95999999999999,63.59,62.45,71.04000000000001,61.39,57.23,72.62,59.37,58.39,66.02,69.87,61.53,66.90000000000001,76.7,60.2,81,83.61,68.68000000000001,61.75,67.18000000000001,63.66,82.56999999999999,63.88,73.03,72.77,67.43000000000001,67.98999999999999,71.73999999999999,62.88,58.85,47.64,51.83,67.20999999999999,63.39,50.41,77.41,70.36,71.98999999999999,81.48999999999999,81.37,86.11,79.56,80.98999999999999,83.09999999999999,79.47,77.73,82.39,75.90000000000001,84.2,79.17,79.88,77.23999999999999,86.64,77.43000000000001,82.2,78.44,83.06,82.27,77.73,80.27,75.62,72.06999999999999,77.64,72.28,78.45999999999999,72.67,80.13,77.64,78.23999999999999,74.34,75.51000000000001,72.55,76.91,77.31,79.20999999999999,74.63,77.09999999999999,75.61,72.89,69.11,70.98999999999999,75.12,73.09999999999999,76.05,68.22,65.15000000000001,75.23999999999999,70.86,67.81,67.98999999999999,72.31,73.22,72.77,74.23999999999999,74.95,73.29000000000001,77.22,71.58,77.03,68.44,76.98999999999999,70.09,73.42,71.48999999999999,75.33,74.91,71.53,69.8,76.3,70.20999999999999,74.68000000000001,72.52,76.37,75.3,76.67,74.44,71.58,73.61,71.78,67.37,67.09999999999999,67.09999999999999,70.95999999999999,62.57,72.28,68.45999999999999,69.73999999999999,69.12,72.51000000000001,61.26,72.14,66.06999999999999,67.91,66.37,71.02,63.87,78.06999999999999,68.64,69.14,59.88,63.16,62.91,68.65000000000001,67.27,62.66,63.42,63.71,61.86,67.31999999999999,58.06,66.78,61.65,67.53,59.66,66.67,68.63,66.03,61.84]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>subjects<\/th>\n      <th>daytime<\/th>\n      <th>alcohol<\/th>\n      <th>speed<\/th>\n      <th>accidents<\/th>\n      <th>weight<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"searching":false,"scrollY":415,"paging":false,"info":false,"columnDefs":[{"className":"dt-right","targets":[1,5,6]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"subjects","targets":1},{"name":"daytime","targets":2},{"name":"alcohol","targets":3},{"name":"speed","targets":4},{"name":"accidents","targets":5},{"name":"weight","targets":6}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="ss-full-model" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="ss-full-model">SS full model</h2>
<table class="table">
<colgroup>
<col style="width: 18%">
<col style="width: 30%">
<col style="width: 7%">
<col style="width: 26%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Variance</th>
<th>Sum of squares</th>
<th>df</th>
<th>Mean squares</th>
<th>F-ratio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Model</td>
<td><span class="math inline">\(\text{SS}_{\text{model}} = \sum{n_k(\bar{X}_k-\bar{X})^2}\)</span></td>
<td><span class="math inline">\(k_{model}-1\)</span></td>
<td><span class="math inline">\(\frac{\text{SS}_{\text{model}}}{\text{df}_{\text{model}}}\)</span></td>
<td><span class="math inline">\(\frac{\text{MS}_{\text{model}}}{\text{MS}_{\text{error}}}\)</span></td>
</tr>
</tbody>
</table>
<p><br></p>
<p>Predicts group means for each cell of the design:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>     speed  alcohol accidents  n
1 none (S) none (A)    2.1060 20
2 some (S) none (A)    2.9445 20
3 much (S) none (A)    3.8880 20
4 none (S) some (A)    3.4435 20
5 some (S) some (A)    4.7625 20
6 much (S) some (A)    5.5790 20
7 none (S) much (A)    5.2970 20
8 some (S) much (A)    6.5125 20
9 much (S) much (A)    7.5720 20</code></pre>
</div>
</div>
</section>
<section id="section" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="section"></h2>
<div class="cell">
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item" id="htmlwidget-6411ef17eac63294c830" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-6411ef17eac63294c830">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180"],["none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","none (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","some (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)","much (S)"],["none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","none (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","some (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)","much (A)"],[2.67,2.64,2.39,2.13,2.16,2.33,1.79,2.37,1.91,1.78,1.56,2.6,2.55,1.8,1.6,2.3,2.27,1.77,2.75,0.75,1.85,2.96,2.68,2.63,2.63,2.98,2.19,3.35,3.03,3.24,3.34,3.37,2.4,3.02,2.25,4.03,3.78,3.11,2.66,3.39,3.52,4.17,4.02,3.91,3.13,3.42,3.5,3.24,4.01,3.82,4.16,4.27,3.55,4.73,4.26,3.63,4.52,4.11,3.12,4.67,3.26,3.46,2.35,4.1,3.46,3.46,3.66,3.78,2.86,3.51,2.95,4.09,3.15,4.2,3.03,3.83,2.72,4.18,3.06,3.76,4.39,4.35,4.8,5.1,3.89,5.38,4.34,5.48,3.49,5.03,4.19,5.39,4.87,5.8,4.03,5.02,4.18,5.55,4.44,5.53,5.13,6.81,5.34,5.33,4.56,5.16,5.76,6.59,4.64,5.64,6.31,6.71,5.03,5.73,5.3,5.7,5.02,5.69,5.06,6.07,4.51,6.44,4.9,5.54,4.59,6.26,4.34,5.91,5.5,5.88,4.24,5.23,4.78,6.03,4.46,5.87,4.33,5.39,5.61,6.13,6.12,6.95,7,6.36,6.49,7.49,5.44,7.24,6.17,6.76,5.93,7.48,5.09,7.11,6,7.07,6.15,7.61,5.21,6.58,6.46,8.210000000000001,6.82,7.66,6.9,7.54,7.98,7.49,7.26,8.800000000000001,7.04,8.550000000000001,7.32,7.73,7.08,8.42,7.05,6.97,7.09,9.07],[4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68,4.68],[2.11,2.11,2.11,2.11,2.11,2.11,2.11,2.11,2.11,2.11,2.11,2.11,2.11,2.11,2.11,2.11,2.11,2.11,2.11,2.11,2.94,2.94,2.94,2.94,2.94,2.94,2.94,2.94,2.94,2.94,2.94,2.94,2.94,2.94,2.94,2.94,2.94,2.94,2.94,2.94,3.89,3.89,3.89,3.89,3.89,3.89,3.89,3.89,3.89,3.89,3.89,3.89,3.89,3.89,3.89,3.89,3.89,3.89,3.89,3.89,3.44,3.44,3.44,3.44,3.44,3.44,3.44,3.44,3.44,3.44,3.44,3.44,3.44,3.44,3.44,3.44,3.44,3.44,3.44,3.44,4.76,4.76,4.76,4.76,4.76,4.76,4.76,4.76,4.76,4.76,4.76,4.76,4.76,4.76,4.76,4.76,4.76,4.76,4.76,4.76,5.58,5.58,5.58,5.58,5.58,5.58,5.58,5.58,5.58,5.58,5.58,5.58,5.58,5.58,5.58,5.58,5.58,5.58,5.58,5.58,5.3,5.3,5.3,5.3,5.3,5.3,5.3,5.3,5.3,5.3,5.3,5.3,5.3,5.3,5.3,5.3,5.3,5.3,5.3,5.3,6.51,6.51,6.51,6.51,6.51,6.51,6.51,6.51,6.51,6.51,6.51,6.51,6.51,6.51,6.51,6.51,6.51,6.51,6.51,6.51,7.57,7.57,7.57,7.57,7.57,7.57,7.57,7.57,7.57,7.57,7.57,7.57,7.57,7.57,7.57,7.57,7.57,7.57,7.57,7.57]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>data.speed<\/th>\n      <th>data.alcohol<\/th>\n      <th>accidents<\/th>\n      <th>grand.mean<\/th>\n      <th>group.mean<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"searching":false,"scrollY":415,"paging":false,"info":false,"columnDefs":[{"className":"dt-right","targets":[3,4,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"data.speed","targets":1},{"name":"data.alcohol","targets":2},{"name":"accidents","targets":3},{"name":"grand.mean","targets":4},{"name":"group.mean","targets":5}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="group-means" class="level2">
<h2 class="anchored" data-anchor-id="group-means">Group means</h2>
</section>
<section id="ss-model-visual" class="level2">
<h2 class="anchored" data-anchor-id="ss-model-visual">SS model visual</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="factorial_independent_ANOVA_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="ss-error" class="level2">
<h2 class="anchored" data-anchor-id="ss-error">SS error</h2>
<table class="table">
<colgroup>
<col style="width: 18%">
<col style="width: 30%">
<col style="width: 7%">
<col style="width: 26%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Variance</th>
<th>Sum of squares</th>
<th>df</th>
<th>Mean squares</th>
<th>F-ratio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Error</td>
<td><span class="math inline">\(\text{SS}_{\text{error}} = \sum{s_k^2(n_k-1)}\)</span></td>
<td><span class="math inline">\(N-k\)</span></td>
<td><span class="math inline">\(\frac{\text{SS}_{\text{error}}}{\text{df}_{\text{error}}}\)</span></td>
<td></td>
</tr>
</tbody>
</table>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">tapply</span>(data<span class="sc">$</span>accidents, <span class="fu">list</span>(data<span class="sc">$</span>speed, data<span class="sc">$</span>alcohol), var)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>vars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          none (A)  some (A)  much (A)
none (S) 0.2406147 0.2694555 0.5228011
some (S) 0.2947734 0.4218829 0.5624618
much (S) 0.2376063 0.4239884 0.5183326</code></pre>
</div>
</div>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1"></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>ss.error <span class="ot">&lt;-</span> <span class="fu">sum</span>(vars <span class="sc">*</span> (ns <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>ss.error</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 66.34642</code></pre>
</div>
</div>
</section>
<section id="ss-error-visual" class="level2">
<h2 class="anchored" data-anchor-id="ss-error-visual">SS error visual</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="factorial_independent_ANOVA_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="ss-a-speed" class="level2 subsection">
<h2 class="subsection anchored" data-anchor-id="ss-a-speed">SS A Speed</h2>
<table class="table">
<colgroup>
<col style="width: 18%">
<col style="width: 30%">
<col style="width: 7%">
<col style="width: 26%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Variance</th>
<th>Sum of squares</th>
<th>df</th>
<th>Mean squares</th>
<th>F-ratio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\hspace{2ex}A\)</span></td>
<td><span class="math inline">\(\text{SS}_{\text{A}} = \sum{n_k(\bar{X}_k-\bar{X})^2}\)</span></td>
<td><span class="math inline">\(k_A-1\)</span></td>
<td><span class="math inline">\(\frac{\text{SS}_{\text{A}}}{\text{df}_{\text{A}}}\)</span></td>
<td><span class="math inline">\(\frac{\text{MS}_{\text{A}}}{\text{MS}_{\text{error}}}\)</span></td>
</tr>
</tbody>
</table>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># m.s1 = mean(subset(data, speed == "none", select = "accidents")$accidents)</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># m.s2 = mean(subset(data, speed == "some", select = "accidents")$accidents)</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># m.s3 = mean(subset(data, speed == "much", select = "accidents")$accidents)</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>s.means <span class="ot">&lt;-</span> <span class="fu">tapply</span>(data<span class="sc">$</span>accidents, data<span class="sc">$</span>speed, mean)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>s.ns <span class="ot">&lt;-</span> <span class="dv">60</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>s.means</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>none (S) some (S) much (S) 
3.615500 4.739833 5.679667 </code></pre>
</div>
</div>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>s.squares <span class="ot">&lt;-</span> (s.means <span class="sc">-</span> <span class="fu">mean</span>(accidents))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>s.squares</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  none (S)   some (S)   much (S) 
1.12961469 0.00378225 1.00266844 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>ss.speed <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="dv">60</span> <span class="sc">*</span> s.squares)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>ss.speed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 128.1639</code></pre>
</div>
</div>
</section>
<section id="ss-a-speed-visual" class="level2">
<h2 class="anchored" data-anchor-id="ss-a-speed-visual">SS A Speed Visual</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="factorial_independent_ANOVA_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="ss-a-speed-error-visual" class="level2">
<h2 class="anchored" data-anchor-id="ss-a-speed-error-visual">SS A Speed Error Visual</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="factorial_independent_ANOVA_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="ss-b-alcohol" class="level2 subsection">
<h2 class="subsection anchored" data-anchor-id="ss-b-alcohol">SS B Alcohol</h2>
<table class="table">
<colgroup>
<col style="width: 18%">
<col style="width: 30%">
<col style="width: 7%">
<col style="width: 26%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Variance</th>
<th>Sum of squares</th>
<th>df</th>
<th>Mean squares</th>
<th>F-ratio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\hspace{2ex}B\)</span></td>
<td><span class="math inline">\(\text{SS}_{\text{B}} = \sum{n_k(\bar{X}_k-\bar{X})^2}\)</span></td>
<td><span class="math inline">\(k_B-1\)</span></td>
<td><span class="math inline">\(\frac{\text{SS}_{\text{B}}}{\text{df}_{\text{B}}}\)</span></td>
<td><span class="math inline">\(\frac{\text{MS}_{\text{B}}}{\text{MS}_{\text{error}}}\)</span></td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>a.means <span class="ot">&lt;-</span> <span class="fu">tapply</span>(data<span class="sc">$</span>accidents, data<span class="sc">$</span>alcohol, mean)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>a.ns <span class="ot">&lt;-</span> <span class="dv">60</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>a.means</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>none (A) some (A) much (A) 
  2.9795   4.5950   6.4605 </code></pre>
</div>
</div>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>a.squares <span class="ot">&lt;-</span> (a.means <span class="sc">-</span> <span class="fu">mean</span>(accidents))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>a.squares</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   none (A)    some (A)    much (A) 
2.886034694 0.006944444 3.176118028 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>ss.alcohol <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="dv">60</span> <span class="sc">*</span> a.squares)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>ss.alcohol</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 364.1458</code></pre>
</div>
</div>
</section>
<section id="ss-b-alcohol-visual" class="level2">
<h2 class="anchored" data-anchor-id="ss-b-alcohol-visual">SS B Alcohol Visual</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="factorial_independent_ANOVA_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="ss-b-alcohol-error-visual" class="level2">
<h2 class="anchored" data-anchor-id="ss-b-alcohol-error-visual">SS B Alcohol Error Visual</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="factorial_independent_ANOVA_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="ss-ab-alcohol-x-speed" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="ss-ab-alcohol-x-speed">SS AB Alcohol x Speed</h2>
<table class="table">
<colgroup>
<col style="width: 18%">
<col style="width: 30%">
<col style="width: 7%">
<col style="width: 26%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Variance</th>
<th>Sum of squares</th>
<th>df</th>
<th>Mean squares</th>
<th>F-ratio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\hspace{2ex}AB\)</span></td>
<td><span class="math inline">\(\text{SS}_{A \times B} = \text{SS}_{\text{model}} - \text{SS}_{\text{A}} - \text{SS}_{\text{B}}\)</span></td>
<td><span class="math inline">\(df_A \times df_B\)</span></td>
<td><span class="math inline">\(\frac{\text{SS}_{\text{AB}}}{\text{df}_{\text{AB}}}\)</span></td>
<td><span class="math inline">\(\frac{\text{MS}_{\text{AB}}}{\text{MS}_{\text{error}}}\)</span></td>
</tr>
</tbody>
</table>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sums of squares for the interaction between speed and alcohol</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>ss.speed.alcohol <span class="ot">&lt;-</span> ss.model <span class="sc">-</span> ss.speed <span class="sc">-</span> ss.alcohol</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>ss.speed.alcohol</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.910727</code></pre>
</div>
</div>
</section>
<section id="mean-squares" class="level2">
<h2 class="anchored" data-anchor-id="mean-squares">Mean Squares</h2>
<div class="columns">
<div class="column">
<p>Mean squares for:</p>
<ul>
<li>Speed</li>
<li>Alcohol</li>
<li>Speed <span class="math inline">\(\times\)</span> Alcohol</li>
</ul>
</div><div class="column">
<p><span class="math display">\[\begin{aligned}
F_{Speed} &amp;= \frac{{MS}_{Speed}}{{MS}_{error}} \\
F_{Alcohol} &amp;= \frac{{MS}_{Alcohol}}{{MS}_{error}} \\
F_{Alcohol \times Speed} &amp;= \frac{{MS}_{Alcohol \times Speed}}{{MS}_{error}} \\
\end{aligned}\]</span></p>
</div>
</div>
</section>
<section id="interaction" class="level2">
<h2 class="anchored" data-anchor-id="interaction">Interaction</h2>
<p><span class="math display">\[F_{Alcohol \times Speed}\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>N          <span class="ot">&lt;-</span> <span class="fu">length</span>(accidents)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>k.speed    <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>k.alcohol  <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>k.model    <span class="ot">&lt;-</span> <span class="dv">9</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>df.speed   <span class="ot">&lt;-</span> k.speed   <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>df.alcohol <span class="ot">&lt;-</span> k.alcohol <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>df.speed.alcohol <span class="ot">&lt;-</span> df.speed <span class="sc">*</span> df.alcohol</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>ms.speed.alcohol <span class="ot">&lt;-</span> ss.speed.alcohol <span class="sc">/</span> df.speed.alcohol</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>df.error <span class="ot">&lt;-</span> N <span class="sc">-</span> k.model</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>ms.error <span class="ot">&lt;-</span> ss.error <span class="sc">/</span> df.error</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="p-value" class="level2">
<h2 class="anchored" data-anchor-id="p-value"><span class="math inline">\(P\)</span>-value</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>F.speed.alcohol <span class="ot">&lt;-</span> ms.speed.alcohol <span class="sc">/</span> ms.error</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>F.speed.alcohol</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.231168</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visualize)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">visualize.f</span>(F.speed.alcohol, df.speed.alcohol, df.error, <span class="at">section =</span> <span class="st">"upper"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="factorial_independent_ANOVA_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
<div class="cell">
<div class="cell-output-display">
<p><img src="factorial_independent_ANOVA_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="partition-the-explained-variance-bonus" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="partition-the-explained-variance-bonus">Partition the explained variance (BONUS)</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="factorial_independent_ANOVA_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="partition-the-explained-variance-bonus-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="partition-the-explained-variance-bonus-1">Partition the explained variance (BONUS)</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="factorial_independent_ANOVA_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In reality, we do not know exactly how the shared variance is distributed across these three sources (IV1, IV2, shared)</p>
</section>
<section id="partition-the-explained-variance-bonus-2" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="partition-the-explained-variance-bonus-2">Partition the explained variance (BONUS)</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="factorial_independent_ANOVA_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li>Fit a model with only IV1, then use that to compute the explained variance for IV2: <span class="math inline">\(SS_{M1} = 70 \rightarrow SS_{IV2} = 130 - 70 = 60\)</span></li>
<li>Fit a model with only IV2, then use that to compute the explained variance for IV1: <span class="math inline">\(SS_{M2} = 50 \rightarrow SS_{IV1} = 130 - 50 = 80\)</span></li>
<li><a href="https://discoverjasp.com/pages/oliver_twisted.html#please-sir-can-i-customize-my-model">See also Oliver Twisted from Chapter 13</a></li>
</ul>
</section>
<section id="contrast" class="level2">
<h2 class="anchored" data-anchor-id="contrast">Contrast</h2>
<p>Planned comparisons</p>
<ul>
<li>Exploring differences of theoretical interest</li>
<li>Higher precision</li>
<li>Higher power</li>
</ul>
</section>
<section id="post-hoc" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="post-hoc">Post-Hoc</h2>
<p>Unplanned comparisons</p>
<ul>
<li>Exploring all possible differences</li>
<li>Adjust p-value for inflated type 1 error
<ul>
<li>P(1 type-I error) = <span class="math inline">\(0.05\)</span></li>
<li>P(not 1 type-I error) = <span class="math inline">\(0.95\)</span></li>
<li>P(not 5 type-I errors) = <span class="math inline">\(0.95^5 = 0.774\)</span></li>
</ul></li>
<li>Bonferroni more conservative, Tukey more permissive</li>
</ul>
<blockquote class="blockquote">
<p><strong>Exam note:</strong> know where the options are, exam question will inform you which correction to use</p>
</blockquote>
</section>
<section id="effect-size-in-anova" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="effect-size-in-anova">Effect size in ANOVA</h2>
<p>General effect size measure: Partial omega squared <span class="math inline">\(\omega_p^2\)</span></p>
<p>How to interpret?</p>
<table class="table">
<colgroup>
<col style="width: 36%">
<col style="width: 35%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">\(\omega^2\)</span> and <span class="math inline">\(\omega_p^2\)</span></th>
<th>Magnitude of Effect</th>
<th>Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0.00–0.009</td>
<td>Very small</td>
<td>Trivial practical importance</td>
</tr>
<tr class="even">
<td>0.01–0.05</td>
<td>Small</td>
<td>Small but meaningful variance explained</td>
</tr>
<tr class="odd">
<td>0.06–0.13</td>
<td>Medium</td>
<td>Moderate variance explained</td>
</tr>
<tr class="even">
<td>≥ 0.14</td>
<td>Large</td>
<td>Substantial variance explained</td>
</tr>
</tbody>
</table>
</section>
<section id="effect-size-in-follow-up-tests" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="effect-size-in-follow-up-tests">Effect size in follow-up tests</h2>
<p>Effect sizes of contrasts or post-hoc comparisons: Cohen’s <span class="math inline">\(d\)</span></p>
<p>How to interpret?</p>
<table class="table">
<colgroup>
<col style="width: 28%">
<col style="width: 40%">
<col style="width: 32%">
</colgroup>
<thead>
<tr class="header">
<th>Cohen’s <em>d</em></th>
<th>Magnitude of Effect</th>
<th>Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0.00–0.19</td>
<td>Very small</td>
<td>Likely negligible in most contexts</td>
</tr>
<tr class="even">
<td>0.20–0.49</td>
<td>Small</td>
<td>Noticeable but modest difference</td>
</tr>
<tr class="odd">
<td>0.50–0.79</td>
<td>Medium</td>
<td>Moderate, practically meaningful difference</td>
</tr>
<tr class="even">
<td>≥ 0.80</td>
<td>Large</td>
<td>Substantial, easily noticeable difference</td>
</tr>
</tbody>
</table>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>